<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Website responsive</title>
  <!-- feather icon -->
  <script src="https://unpkg.com/feather-icons"></script>
  <!-- font google -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet" />
  <!-- Css -->
  <link rel="stylesheet" href="./css/daftar.css" />
</head>

<body>
  <!-- Navbar Start -->
  <nav class="navbar">
    <a href="index.html" class="navbar-logo">Charity<span>DONATION</span>.</a>
    <div class="navbar-nav">
      <ul>
        <a href="index.html">Home</a>
          <a href="index.html#about">About</a>
          <a href="index.html#menu">Services</a>
          <a href="index.html#contact">Contact Us</a>
        <li id="liMasuk" >
          <a href="#"
            ><i data-feather="log-in" class="login"></i>Masuk/Daftar</a
          >
          <div class="dropdown-menu">
            <ul>
              <li><a href="login.html">Masuk</a></li>
              <li><a href="daftar.html">Daftar</a></li>
            </ul>
          </div>
        </li>
        <li id="liUser">
          <a href="#"
            ><i data-feather="user" class="login"></i>User</a
          >
          <div class="dropdown-menu">
            <ul>
              <li><a href="profile.html">Profile</a></li>
              <li><a href="history.html">History</a></li>
              <li id="liLogout"><a href="login.html"><i data-feather="log-out"></i> Logout</a></li>
              <li id="liDelete"><a href="daftar.html">Delete Account</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>

    <!-- search button -->
    <div class="navbar-extra">
      <!-- <a href="#" id="shopping-cart"><i data-feather="shopping-cart"></i></a> -->
      <a href="#" id="hamburger-menu"><i data-feather="menu"></i></a>
    </div>
    <!-- search button -->
    <!-- search form start -->

    <!-- search form end -->
  </nav>

  <!-- Navbar End -->

  <!-- Contact Section Start -->
  <section id="contact" class="contact">
    <div class="content">
      <div class="row">
        <form id="userForm">
          <!--  -->
          <h4>Silahkan Daftar</h4>
          <div class="input-group">
            <label for="nama">Nama</label>
            <input type="text" name="name" id="name" placeholder="Masukan Nama" />
          </div>

          <div class="input-group">
            <label for="email">Email</label>
            <input type="email" name="email_user" id="email_user" placeholder="Masukan Email" />
          </div>
          <div class="input-group">
            <label for="nama">No.Telp</label>
            <input type="number" name="phone_number" id="phone_number" placeholder="Masukan Nomer Telepon" />
          </div>

          <div class="input-group">
            <label for="nama">Password</label>
            <input type="password" name="psw_user" id="psw_user" placeholder="Masukan Nomer Telepon" />
          </div>

          <button type="submit" class="popup-menu disable" id="popup-menu" value="payment">
            Register
          </button>
        </form>
      </div>
    </div>
    </div>
  </section>

  <!-- Footer Start -->
  <footer>
    <div class="socials">
      <a href="#">
        <i data-feather="instagram"></i>
      </a>
      <a href="#">
        <i data-feather="facebook"></i>
      </a>
    </div>
    <div class="links">
      <a href="#home">Home</a>
      <a href="#about">About us</a>
      <a href="#menu">Menu</a>
      <a href="#contact">Contact</a>
    </div>

    <div class="credit">
      <p>Created by <a href="">Rafi</a>. &copy;2024</p>
    </div>
  </footer>
  <!-- Footer End -->

  <!-- feather icon -->
  <script>
    feather.replace();
  </script>

  <!-- Javascript -->
  <script src="js/daftar.js" async></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
</body>

<script>
  document
    .getElementById('userForm')
    .addEventListener('submit', function (event) {
      event.preventDefault()
      const name = document.getElementById('name').value
      const phone_number = document.getElementById('phone_number').value
      const email_user = document.getElementById('email_user').value
      const psw_user = document.getElementById('psw_user').value
      const data = {
        name,
        phone_number,
        email_user,
        psw_user,
      }
      fetch("http://localhost:3000/api/users", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      })
        .then((response) => {
          switch (response.status) {
            case 400:
              alert("email already exist", "use another email")
              break;
            case 201:
              return response.json()
              break;
            default:
              break;
          }
        })
        .then((data) => {
          
          // console.log(data.id.user_id)
          // sessionStorage.setItem("userId", data.id.user_id)
          if (data) {
            window.location.href = "./login.html"
          }
        })
        .catch((error) => {
          console.log(error)
        })
    });
    
    window.onload = (async) => {
      const id = sessionStorage.getItem("userId");
      // console.log(id);
      if (id) {
        document.getElementById("liMasuk").style.display = "none";
      } else {
        document.getElementById("liUser").style.display = "none";
      }
    };
    
    $("#liLogout").click(function () {
 sessionStorage.removeItem("userId")
});
</script>

</html>